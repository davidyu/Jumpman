package{	import Box2D.Collision.Shapes.b2PolygonDef;	import Box2D.Common.Math.b2Vec2;	import Box2D.Dynamics.b2Body;	import Box2D.Dynamics.b2BodyDef;		import com.neriksworkshop.lib.ASaudio.Track;		import flash.display.DisplayObject;	import flash.display.DisplayObjectContainer;	import flash.display.MovieClip;	import flash.display.Sprite;	import flash.display.Stage;	import flash.events.KeyboardEvent;		//TODO: make a function that calculates the position of the switch automatically	public class Switch extends Actor	{				private var _state:int = 0; //0 = OFF, 1 = ON		private var _target:SwitchControlledObject; //reference to the object the switch controls		private var _switchSprite:MovieClip;				//sound effects		private var _click:Track = new Track("sfx/click.mp3");						public function Switch(canvas:DisplayObjectContainer, stage:Stage, target:SwitchControlledObject, location:b2Vec2, switch_height:Number = 80, switch_width:Number = 70) {									var switchSprite:MovieClip = new SwitchSprite();						canvas.addChild(switchSprite);			_switchSprite = switchSprite;						//define shape			var switchShapeDef:b2PolygonDef = new b2PolygonDef();			switchShapeDef.SetAsBox(PhysiVals.meters(switch_width / 2), PhysiVals.meters(switch_height / 2));			switchShapeDef.friction = 0.0;			switchShapeDef.restitution = 0.0;			switchShapeDef.density = 0.0;			switchShapeDef.isSensor =true;						switchShapeDef.userData = this;									//define body			var switchBodyDef:b2BodyDef = new b2BodyDef();			switchBodyDef.position.Set(PhysiVals.meters(location.x), PhysiVals.meters(location.y));			switchBodyDef.fixedRotation = true;						var switchBody:b2Body = PhysiVals.world.CreateBody(switchBodyDef);			switchBody.CreateShape(switchShapeDef);												_target = target;						super(switchBody, switchSprite, false);			//trace(switchBody.GetPosition().y);						//stage.addEventListener(KeyboardEvent.KEY_DOWN, tempSwitchControls);					}				public function tempSwitchControls(event:KeyboardEvent):void		{						if(event.keyCode == 48) {				if(_state > 0)  {					turnOff();					_state = 0;				} else {					turnOn();					_state = 1;				}			}					}				public function activate():void		{			if(_state > 0)  {				turnOff();				_state = 0;			} else {				turnOn();				_state = 1;			}						_click.loop = false;			_click.start();								}				public function turnOn():void		{			_target.switchOnAction();			_switchSprite.gotoAndPlay("turnOn");		}				public function turnOff():void		{			_target.switchOffAction();			_switchSprite.gotoAndPlay("turnOff");		}			}}